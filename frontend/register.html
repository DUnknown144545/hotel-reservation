<!DOCTYPE html>
<html>

<head>
  <title>Hotel Reservation - Register</title>
  <link rel="stylesheet" type="text/css" href="logreg.css">
</head>

<body>
  <div class="container">
    <h2>Register</h2>

    <input type="text" id="username" placeholder="Enter Username">
    <input type="password" id="password" placeholder="Enter Password">
    <input type="password" id="confirmPassword" placeholder="Confirm Password">

    <select id="role">
      <option value="Guest">Guest</option>
      <option value="Receptionist">Receptionist</option>
      <option value="Admin">Admin</option>
    </select>

    <button onclick="register()">Register</button>

    <p>Already have an account? <a href="index.html">Login</a></p>
  </div>
</body>

<script>
  async function register() {
    const username = document.getElementById("username").value.trim();
    const password = document.getElementById("password").value.trim();
    const confirmPassword = document.getElementById("confirmPassword").value.trim();
    const role = document.getElementById("role").value;

    if (!username || !password || !confirmPassword) {
      alert("Please fill in all fields");
      return;
    }

    if (password !== confirmPassword) {
      alert("Passwords do not match");
      return;
    }

    if (password.length < 6) {
      alert("Password must be at least 6 characters long");
      return;
    }

    try {
      // Send registration request to backend
      const response = await fetch('http://localhost:3000/api/register', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ username, password, role })
      });

      const data = await response.json();

      if (data.success) {
        alert(`Registered successfully as ${role}! Please login.`);
        window.location.href = "index.html";
      } else {
        alert(data.message);
      }
    } catch (error) {
      console.error('Registration error:', error);
      alert("Connection error. Make sure the server is running.");
    }
  }

  // Allow Enter key to submit
  document.addEventListener('keypress', function (event) {
    if (event.key === 'Enter') {
      register();
    }
  });
</script>
</html>